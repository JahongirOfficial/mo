# üöÄ –ë–´–°–¢–†–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï 408 TIMEOUT –ü–†–ò –ó–ê–ì–†–£–ó–ö–ï –í–ò–î–ï–û

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞
–ó–∞–≥—Ä—É–∑–∫–∞ –≤–∏–¥–µ–æ –æ–±—Ä—ã–≤–∞–µ—Ç—Å—è –Ω–∞ 13-14% (37MB –∏–∑ 276MB) —Å –æ—à–∏–±–∫–æ–π **408 Request Timeout**.

## ‚úÖ –ü—Ä–∏—á–∏–Ω–∞
**Content-Type —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤—Ä—É—á–Ω—É—é –±–µ–∑ boundary** –≤ axios –∑–∞–ø—Ä–æ—Å–µ ‚Üí multer –Ω–µ –º–æ–∂–µ—Ç —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å multipart ‚Üí —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –≤–∏—Å–∏—Ç ‚Üí nginx timeout.

## üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (—É–∂–µ –≤–Ω–µ—Å–µ–Ω—ã)

### 1. Frontend: `src/api/index.ts`
```typescript
// ‚ùå –£–î–ê–õ–ï–ù–û:
headers: { 'Content-Type': 'multipart/form-data' }

// ‚úÖ Axios —Å–∞–º —É—Å—Ç–∞–Ω–æ–≤–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π header —Å boundary
```

### 2. Backend: `server/routes/upload.ts`
- ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω limit: 500MB ‚Üí 2GB
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### 3. Frontend: `src/pages/admin/AdminDarslar.tsx`
- ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω –ª–∏–º–∏—Ç: 500MB ‚Üí 2GB
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ 408/413/502

## üì¶ –î–µ–ø–ª–æ–π

### Windows (–ª–æ–∫–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞):
```powershell
# 1. –°–æ–±—Ä–∞—Ç—å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥
npm run build

# 2. –ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä (–≤—ã–±–µ—Ä–∏—Ç–µ –æ–¥–∏–Ω –∏–∑ —Å–∫—Ä–∏–ø—Ç–æ–≤)
.\deploy-vps.ps1
# –∏–ª–∏
.\deploy-164.ps1
# –∏–ª–∏
.\deploy-local-to-164.ps1
```

### Linux/Mac (–ª–æ–∫–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞):
```bash
# 1. –°–æ–±—Ä–∞—Ç—å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥
npm run build

# 2. –ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä
./deploy-vps.sh
# –∏–ª–∏
./deploy-164.sh
```

### –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ (SSH):
```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
pm2 restart moo

# –°–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
pm2 logs moo --lines 100

# –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å upload –ª–æ–≥–∏
pm2 logs moo | grep -E "Upload|üì§|‚ùå|‚úÖ"
```

## üß™ –¢–µ—Å—Ç

1. –û—Ç–∫—Ä—ã—Ç—å –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å: https://mukammalotaona.uz/admin/darslar
2. –ù–∞–∂–∞—Ç—å "Qo'shish" ‚Üí –≤—ã–±—Ä–∞—Ç—å —Ç–∏–ø "Video"
3. –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤–∏–¥–µ–æ 200-300MB
4. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ö–æ–¥–∏—Ç –¥–æ 100% –±–µ–∑ –æ–±—Ä—ã–≤–∞

### –ß—Ç–æ —Å–º–æ—Ç—Ä–µ—Ç—å –≤ –ª–æ–≥–∞—Ö:
```
‚úÖ –£—Å–ø–µ—à–Ω–æ:
üì§ Upload progress: 50.23MB received (2.15MB/s)
üì§ Upload progress: 100.45MB received (2.18MB/s)
‚úÖ File uploaded successfully: { filename: 'abc123.mp4', size: '275.93MB' }
‚úÖ Upload completed successfully. Duration: 127.5 seconds

‚ùå –ï—Å–ª–∏ –æ–±—Ä—ã–≤:
üì§ Upload progress: 37.14MB received (1.85MB/s)
‚ùå Connection CLOSED before response sent. Duration: 20.3 seconds
```

## üìã –ß–µ–∫-–ª–∏—Å—Ç

- [ ] –ö–æ–¥ –∏–∑–º–µ–Ω—ë–Ω (—É–∂–µ —Å–¥–µ–ª–∞–Ω–æ)
- [ ] `npm run build` –≤—ã–ø–æ–ª–Ω–µ–Ω
- [ ] –§–∞–π–ª—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- [ ] `pm2 restart moo` –≤—ã–ø–æ–ª–Ω–µ–Ω
- [ ] –¢–µ—Å—Ç –∑–∞–≥—Ä—É–∑–∫–∏ 200-300MB –≤–∏–¥–µ–æ
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ —Å–µ—Ä–≤–µ—Ä–∞
- [ ] –¢–µ—Å—Ç –∑–∞–≥—Ä—É–∑–∫–∏ 1GB –≤–∏–¥–µ–æ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

## üÜò –ï—Å–ª–∏ –Ω–µ –ø–æ–º–æ–≥–ª–æ

1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å Cloudflare:**
   - Free plan –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç upload –¥–æ 100MB
   - –ù—É–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å –¥–ª—è `/api/upload/*` –∏–ª–∏ –∞–ø–≥—Ä–µ–π–¥

2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ Nginx:**
   ```bash
   tail -f /var/log/nginx/error.log
   ```

3. **–£–≤–µ–ª–∏—á–∏—Ç—å Nginx timeout (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ):**
   ```nginx
   # –í nginx-moo-final.conf
   proxy_read_timeout 3600s;  # 1 —á–∞—Å
   ```

4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ—Å—É—Ä—Å—ã VPS:**
   ```bash
   free -h    # RAM
   df -h      # Disk
   top        # CPU
   ```

## üìö –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
–°–º. `doc/VIDEO_UPLOAD_FIX.md`

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –¥–µ–ø–ª–æ—é  
**–î–∞—Ç–∞:** 2026-01-19
